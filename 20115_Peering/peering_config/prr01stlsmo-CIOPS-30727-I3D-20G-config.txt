
This Peering config is for CIOPS-30727 in prr01stlsmo for I3D with capacity AE1076-20G


#CHANGE SPECIFIC PRE-CHECKS BELOW!

Router Name: prr01stlsmo

show interfaces ae1076
show lacp interfaces ae1076
#Expected Output : ae1076 should free


show interfaces et-0/0/0:1
show interfaces diagnostics optics et-0/0/0:1 | match dBm | except threshold| match dBm | except threshold
#Expected Output: link light level should be good and no errors to be seen!
show interfaces et-0/0/0:2
show interfaces diagnostics optics et-0/0/0:2 | match dBm | except threshold| match dBm | except threshold
#Expected Output: link light level should be good and no errors to be seen!


show route 138.128.140.9/31
#Expected Output: 138.128.140.9/31 IPv4 Space should be free and should not be present in the routing table


show route 2a04:c606:1::9/126
#Expected Output: 2a04:c606:1::9/126 IPv6 Space should be free and should not be present in the routing table


sh configuration | match p-49544-I3D | display set
#Expected Output: Ensure the new group being created doesnt exist already. if group already exists, notify P&D, only neighbor need to be added to existing group
#WARNING: If BGP group already existed, chances of overwrite possible!! USE CAUTION!!


show bgp summary | m 49544
#Expected Output: Check if BGP neighbors exist, if first turn up, then there should be no output

show route advertising-protocol bgp 138.128.140.8
#Expected Output: No BGP neighbor should exist


show route receive-protocol bgp 138.128.140.8
#Expected Output: No BGP neighbor should exist


show route advertising-protocol bgp 2a04:c606:1::8
!Expected Output: No BGP neighbor should exist


show route receive-protocol bgp 2a04:c606:1::8
#Expected Output: No BGP neighbor should exist




#CHANGE SPECIFIC CONFIGURATIONS BELOW!

START

Router Name: prr01stlsmo

#LAG 1 Interface Configs!
set interfaces ae1076 description "[TYPE=PEER][BW=20G][NAME=I3D][AS=49544][IP=138.128.140.8]"
set interfaces ae1076 aggregated-ether-options minimum-links 1
set interfaces ae1076 aggregated-ether-options link-speed 10g
set interfaces ae1076 aggregated-ether-options lacp active
set interfaces ae1076 unit 0 family inet apply-groups rpf
set interfaces ae1076 unit 0 family inet filter input EDGE_IN_IPV4_FILTER
set interfaces ae1076 unit 0 family inet address 138.128.140.9/31
set interfaces ae1076 unit 0 family inet6 apply-groups IPv6-RPF-GROUP
set interfaces ae1076 unit 0 family inet6 filter input EDGE_IN_IPV6_FILTER
set interfaces ae1076 unit 0 family inet6 address 2a04:c606:1::9/126
set class-of-service interfaces ae1076 apply-groups PEER_QOS

#Interface Config LAG!

set interfaces et-0/0/0:1 description "[TYPE=PEER][BW=100G][NAME=I3D][AS=49544][LAG=1076][GRNT=chn00499470][JIRA=CIOPS-30727][CCID=21374446][PCID=]"
set interfaces et-0/0/0:1 gigether-options 802.3ad ae1076
set interfaces et-0/0/0:1 hold-time up 500
set interfaces et-0/0/0:1 hold-time down 0
set interfaces et-0/0/0:1 damping half-life 1
set interfaces et-0/0/0:1 damping max-suppress 4
set interfaces et-0/0/0:1 damping reuse 750
set interfaces et-0/0/0:1 damping suppress 2000
set interfaces et-0/0/0:1 damping enable
set interfaces et-0/0/0:2 description "[TYPE=PEER][BW=100G][NAME=I3D][AS=49544][LAG=1076][GRNT=chn00499471][JIRA=CIOPS-30727][CCID=21374447][PCID=]"
set interfaces et-0/0/0:2 gigether-options 802.3ad ae1076
set interfaces et-0/0/0:2 hold-time up 500
set interfaces et-0/0/0:2 hold-time down 0
set interfaces et-0/0/0:2 damping half-life 1
set interfaces et-0/0/0:2 damping max-suppress 4
set interfaces et-0/0/0:2 damping reuse 750
set interfaces et-0/0/0:2 damping suppress 2000
set interfaces et-0/0/0:2 damping enable



#BGP Configs!

set protocols bgp group p-49544-I3D apply-groups bgp-peer
set protocols bgp group p-49544-I3D description I3D_AS49544_SFI
set protocols bgp group p-49544-I3D import INBOUND-PEERS
set protocols bgp group p-49544-I3D import FINAL-POLICY
set protocols bgp group p-49544-I3D family inet unicast prefix-limit maximum 10000
set protocols bgp group p-49544-I3D family inet unicast prefix-limit teardown 90
set protocols bgp group p-49544-I3D family inet6 unicast prefix-limit maximum 1000
set protocols bgp group p-49544-I3D family inet6 unicast prefix-limit teardown 90
set protocols bgp group p-49544-I3D export OUTBOUND-PEERS-FILTER
set protocols bgp group p-49544-I3D export ALL-REGIONAL-AGGS
set protocols bgp group p-49544-I3D export OUTBOUND-PEERS-KMA
set protocols bgp group p-49544-I3D export FINAL-POLICY
set protocols bgp group p-49544-I3D peer-as 49544
set protocols bgp group p-49544-I3D neighbor 138.128.140.8
set protocols bgp group p-49544-I3D neighbor 138.128.140.8 authentication-key jutran7dEbUwr6c9
set protocols bgp group p-49544-I3D neighbor 2a04:c606:1::8 family inet6 unicast
 
set protocols bgp group p-49544-I3D neighbor 2a04:c606:1::8 authentication-key jutran7dEbUwr6c9 

END


#CHANGE SPECIFIC POST-CHECKS BELOW!

Router Name: prr01stlsmo

show int ae1076
show lacp interfaces ae1076
#Expected Output : ae1076 should be UP

show route 138.128.140.9/31
#Expected Output: 138.128.140.9/31 IPv4 Space should be present as connected route in the routing table

show route 2a04:c606:1::9/126
#Expected Output: 2a04:c606:1::9/126 IPv6 Space should be present as connected route in the routing table

ping 138.128.140.8 source 138.128.140.9 count 1000 rapid
ping 2a04:c606:1::8 source 2a04:c606:1::9 count 1000 rapid


show bgp summary | m 49544
#Expected Output: Newly configured 138.128.140.8 & 2a04:c606:1::8 BGP neighbors state to be UP

show bgp neighbor 138.128.140.8
show bgp neighbor 2a04:c606:1::8
#Expected Output: Check if the newly configured neighbors are looking good.


show route advertising-protocol bgp 138.128.140.8
#Expected Output: AS20115 full customer route IPV4 table should be exported


show route receive-protocol bgp 138.128.140.8
#Expected Output: AS49544 IPv4 routes should be received


show route advertising-protocol bgp 2a04:c606:1::8
#Expected Output: AS20115 full customer route IPV6 table should be exported


show route receive-protocol bgp 2a04:c606:1::8
#Expected Output: AS49544 IPv6 routes should be received




show interfaces et-0/0/0:1
show interfaces et-0/0/0:1 extensive | match err
show interfaces et-0/0/0:2
show interfaces et-0/0/0:2 extensive | match err
#Expected Output: no errors to be seen!

